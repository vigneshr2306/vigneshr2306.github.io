<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Vignesh  Ravikumar | MViTv2 Improved multiscale vision transformers for classification and detection</title>
    <meta name="author" content="Vignesh  Ravikumar" />
    <meta name="description" content="MViTv2 Improved multiscale vision transformers for classification and detection Paper Review" />
    <meta name="keywords" content="robotics, 3D computer vision, deep learning" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://vigneshr2306.github.io/blog/2022/MVitv2/">
    
    <!-- Dark Mode -->
    

    <!-- Google Analytics -->
    

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-224232394-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-224232394-1');
</script>
  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://vigneshr2306.github.io/"><span class="font-weight-bold" style="color: #03aaff">Vignesh</span>   Ravikumar</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/assets/pdf/Vignesh_Ravikumar_Resume.pdf" target="_blank">resume</a>
              </li>
              <!-- <li class="nav-item ">
                <a class="nav-link" href="/assets/pdf/Sundar_CV.pdf" target="_blank">vitae</a>
              </li> -->

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">MViTv2 Improved multiscale vision transformers for classification and detection</h1>
    <p class="post-meta">November 4, 2022</p>
    <p class="post-tags">
      <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>
        ·  
        <a href="/blog/category/paper-review">
          <i class="fas fa-tag fa-sm"></i> paper-review</a>  
          

    </p>
  </header>

  <article class="post-content">
    <p>Citation: Li, Yanghao and Wu, Chao-Yuan and Fan, Haoqi and Mangalam, Karttikeya and Xiong, Bo and Malik, Jitendra and Feichtenhofer, Christoph, “MViTv2: Improved multiscale vision transformers for classification and detection” 2021 IEEE Conference on Computer Vision and Pattern Recognition.<br><br>
Brief Summary:<br>
Convolutional neural networks (CNNs) are beginning to be replaced by Vision Transformers (ViTs) in many computer vision tasks. However, CNNs continue to possess architectural advantages over ViTs in computer vision tasks. For instance, locality is a key component of the convolution technique that CNNs inherit when handling image input (since images tend to hold locally-similar properties). The pooling of layers inside the network can give computational efficiency and hierarchical higher-level feature learning at the top layers, which is another aspect of CNN architecture. The paper on MViT introduced pooling layers to improve ViTs and this paper is an extension of that work. For improved accuracy and computational efficiency, this work provides decomposed relative positional embeddings and residual pooling connections. Additionally, it attained SOTA in the three Visual Recognition categories that received the highest evaluations. MViTv2 boasts cutting-edge performance: 86.1% on Kinetics-400 video classification; 88.8% accuracy on ImageNet classification, and 56.1 APbox on COCO object identification.<br><br></p>

<p>Main Contributions:<br>
Leveraging decomposed location distances to insert position information into Transformer blocks through shift-invariant positional embeddings.
A residual pooling connection to offset the impact of pooling strides on the computation of attention.
Combining hybrid window attention with attention pooling helps improve the accuracy/computing trade-off.
Strengths:
This paper achieves state-of-the-art results in ImageNet classification with 88.8% accuracy.
This paper shows better performance than other ViT architectures such as Swin Transformer.
Not just classification, they have also explored domains such as Object Detection and Video Recognition with state-of-the-art results.
The paper is well-written; the code is provided for reproducibility, and has enough mathematical explanations and supporting figures.<br><br>
Weakness:<br>
When compared to MViTv1, this paper introduces very few changes to the existing architecture, which is primitive.
The paper does not discuss where the model would fail.<br><br></p>

<p>In-Depth Analysis of Strengths and Weaknesses:<br>
The MViT paper relies heavily on absolute position embedding of the patches of images, which ignores the fundamental principle of shift-invariance. This paper adds a relative positional embedding concept that only depends on the relative location distance between tokens into the pooled self-attention computation. Along the spatiotemporal axes, distant computation is decomposed to reduce complexity. <br><br>
To increase information flow and facilitate the training of pooling attention blocks in MViT, residual pooling connections are used. Due to the cheap cost of adding the pooled query sequence, this update continues to benefit from low-complexity attention computation with significant advancements in key and value pooling.<br><br>
Self-Attention used in transformers is computationally expensive based on the number of tokens used. The Hybrid type Pooling Attention along with Feature Pyramid Network is used in this work for each window, and it outperformed the Swin Transformer in terms of performance.<br><br>
The paper achieves state-of-the-art results in ImageNet Classification, Object Detection, and Video Recognition. The experimental results are explained in the next section. The paper is explained very well, with supporting mathematical explanations and equations. However, the changes made in the paper seem primitive to the previous iteration of MViT and do not significantly improve the results. The paper also does not discuss the possible limitations.<br><br></p>

<p>Experimental Results:<br>
In this study, multiscale vision transformers were used to test three downstream tasks.
Classification: The state-of-the-art on the ImageNet leaderboard, MViTv2 achieves roughly 1% greater accuracy with 10% fewer flops and parameters compared to MViTv1 and considerable gains over Swin and DeiT transformers. Additionally, SOTA’s performance in the community’s most recent full-size crop testing is reported by MViTv2.
Object Detection: In terms of object detection, the MaskRCNN framework’s MViTv2 backbone outperformed transformer-based backbones (Swin, ViL, and MViTv1) as well as CNN backbones (ResNet, ResNext, etc.). MViTv2 displays a 2.5 AP box/AP mask improvement over Swin transformer backbone. Similar encouraging patterns were observed in tests using the Cascade MaskRCNN architecture.
Self-attention ablation studies: In COCO and ImageNet (IN) assessments, the MViTv2 attention mechanisms (pooling and Hwin) are contrasted with alternative attention mechanisms (global(full), windowed, and Shiftedwindow). The following findings were made:
When there are no cross-window connections in the default window of ViTB-based models, accuracy in the top-1 reduces by 2% but FLOPs and memory consumption go down. Hwin window outperforms Swin by +1.7% while Swin attention only recovers +0.4%. With 38% fewer failures, attention pooling exhibits the best accuracy/computational trade-offs. When Hwin and attention are combined, object detection performance is at its highest.<br><br>
Extensions:<br>
This paper can be extended to various vision applications such as instance segmentation as a vision backbone. It can also be used in applications such as visual inspection and quality management in manufacturing, cancer and tumor detection in healthcare, and vehicle re-identification and pedestrian detection in transportation.<br><br>
Comments:<br>
MViT, which introduced general hierarchical architecture structure to visual recognition, showed better performance than other ViT architectures (e.g. Swin Transformer) and achieved SOTA in various tasks such as classification, object detection, instance segmentation, and video recognition. Transformer-based architecture is expected to be widely used in various studies in the future as it is rapidly developing.</p>

  </article>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Vignesh  Ravikumar. 
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-224232394-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-224232394-1');
  </script>
  </body>
</html>

